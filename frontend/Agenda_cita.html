<!-- Agenda.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Meta para codificación y responsive -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grandstate Customs | Agendar Cita</title>
  <!-- Enlace al CSS -->
  <link rel="stylesheet" href="stylessAgenda_cita.css" />
</head>
<body>

<header class="header">
  <div class="header-container">

    <div class="logo">
      <img src="Logo.png" alt="Logo Grandstate Customs">
    </div>

    <div class="header-text">
      <h1>Grandstate Customs</h1>
      <p>Mecánica inteligente</p>
    </div>

    <nav>
      <ul>
        <li><a class="nav-link" href="Inicio_taller.html">Inicio</a></li>
        <li><a class="nav-link" href="Servicios.html">Servicios</a></li>
        <li><a class="nav-link active" href="Agenda_cita.html">Agendar Cita</a></li>
        <li><a class="nav-link" href="Contacto.html">Contacto</a></li>
        <li><a class="nav-link" href="Tienda.html">Tienda</a></li>
        <li>
            <a class="nav-link" href="carrito.html">
              Carrito <span id="cartCount" class="cart-badge" style="display:none;">0</span>
            </a>
        </li>

        <li id="adminItem" style="display:none;">
       <a class="nav-link" href="Admin_panel.html">Panel Admin</a>
       </li>
      </ul>
    </nav>

    <button class="logout-btn" onclick="logout()">Cerrar sesión</button>
  </div>
</header>

<!-- Main: formulario y lista de citas -->
<main>
  <h2>Agenda tu cita</h2>

  <!-- Mensaje de estado -->
  <div id="message" aria-live="polite"></div>

  <!-- Formulario para agendar/editar cita -->
  <form id="citaForm" novalidate>
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" name="nombre" required />

    <label for="telefono">Teléfono:</label>
    <input type="tel" id="telefono" name="telefono" inputmode="numeric" required />

    <label for="servicio">Servicio:</label>
    <select id="servicio" name="servicio" required>
      <option value="">-- Selecciona --</option>
      <option value="Mantenimiento">Mantenimiento</option>
      <option value="Cambio de aceite">Cambio de aceite</option>
      <option value="Diagnóstico">Diagnóstico</option>
    </select>

    <!-- Fila para fecha y hora -->
    <div class="row">
      <div class="col">
        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha" name="fecha" required />
      </div>
      <div class="col small">
        <label for="hora">Hora:</label>
        <input type="time" id="hora" name="hora" min="09:00" max="18:00" step="1800" required />
      </div>
    </div>

    <!-- Botón submit y indicador de edición -->
    <div style="margin-top:10px;">
      <button id="submitBtn" type="submit">Confirmar cita</button>
      <span id="editingIndicator" class="editing-indicator" hidden>Modo edición</span>
    </div>
  </form>

  <!-- Sección de lista de citas -->
  <section id="listaCitas" style="display:none;">
      <h3>Citas Agendadas</h3>
      <ul id="citasList"></ul>
   </section>

<section id="userNotice" style="display:none;">
  <h3>Información</h3>
  <p>Tu cita se registró correctamente. El historial y gestión de citas es solo para administradores.</p>
</section>
</main>

<!-- Footer -->
<footer>
  <p>&copy; 2026 Grandstate Customs</p>
</footer>

<!-- Script JS para manejo de citas -->
<script src="ScripMecanico.js" defer></script>

<script src="auth.js"></script>

<script>
  checkAuth();
  updateCartCount(); // ✅ contador carrito

  document.addEventListener("DOMContentLoaded", () => {
    const role = localStorage.getItem("role");
    const adminItem = document.getElementById("adminItem");

    if (adminItem && role === "admin") {
      adminItem.style.display = "list-item";
    }
  });
</script>

 <script>
  // Mostrar lista solo si admin
  const role = localStorage.getItem("role");
  const lista = document.getElementById("listaCitas");
  const notice = document.getElementById("userNotice");

  if (role === "admin") {
    lista.style.display = "block";
  } else {
    notice.style.display = "block";
  }
 </script>
</body>
</html>